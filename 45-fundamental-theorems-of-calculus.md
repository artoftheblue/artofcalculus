# Фундаментальные теоремы математического анализа

Итак, у нас всё готово, чтобы доказать две фундаментальные теоремы анализа.

(first_fundamental_theorem)=
:::{prf:theorem}[Первая фундаментальная теорема]
Пусть $a<b$, $a,b\in \mathbb{R}$ и пусть $f:[a,b] \to \mathbb{R}$ — интегрируемая по Риману функция на этом отрезке. Пусть $F:[a,b] \to \mathbb{R}$ — функция определённая следующая образом
$$
F(x): = \int_{[a,x]}f.
$$
Тогда $F$ непрерывна и более того, если $x_0 \in [a,b]$ и если $f$ — непрерывна в точке $x_0$, тогда $F$ дифференцируема в точке $x_0$, $F'(x_0) = f(x_0).$
:::

(theorem-4-16)=
:::{prf:proof}
:class: dropdown
:nonumber:~

(1) Покажем, что функция $F(x)$ непрерывна на $[a,b].$

Пусть $a\le x<y \le b$, тогда согласно теореме [](#mega_theorem_for_int) 8), получаем
$$\begin{align*}
F(y) &:=& = \int_{[a,y]}f \\
&=& \int_{[a,x]} f + \int_{(x,y]}f \\
&=& F(x) + \int_{(x,y]}f,
\end{align*}$$
**т.е.,**
$$
F(y) - F(x) = \int_{(x,y]}f.
$$

Так как $f$ — интегрируема по Риману на $[a,b]$, то согласно замечанию [](#why_bounded), $f$ — ограничена на $[a,b]$, **т.е.,** найдётся такое число $M$, что $-M \le f(x) \le M$ для всех $x \in [a,b].$ Тогда, согласно теореме [](#mega_theorem_for_int) 5., 6., получаем
$$
\int_{(x,y]}f \le \int_{(x,y]}M = M(y-x)
$$
и
$$
\int_{(x,y]}f \ge \int_{(x,y]} (-M) = -M(y-x),
$$
**т.е.,**
$$
|F(y) - F(x)| \le M (y-x).
$$

Если $x>y$ то аналогичные рассуждения приведут к неравенству
$$
|F(y) - F(x)| \le M (x-y).
$$

Если $x = y$, то $F(x) = F(y)$, таким образом, мы получаем, что 
$$
\left| F(y) - F(x) \right| \le M |x-y|.
$$

Пусть теперь $(x_n)$ — произвольная последовательность в $[a,b]$, тогда по теореме Больцано—Вейрештрасса [](#B-W), она имеет предел, скажем $x: = \lim_{n\to \infty }x_n$. Имеем
$$
-M |x_n - x| \le F(x_n) - F(x) \le M|x_n-x| 
$$
для каждого $n \ge 1.$ Согласно Теореме [](#a+b,ca,ab) и предложению [](#lim(a_n-a)=0), $\lim_{n\to \infty} (-M|x_n - x|) = \lim_{n\to \infty} (M|x_n - x|) = 0$, и тогда по лемме о зажатой последовательности [](#sqeezy), получаем, что
$$
\lim_{x_n \to x}F(x_n) = F(x),
$$
для любой последовательности $x_n$ в $[a,b]$, но тогда по теореме [](#lim=>for_any_sequence) получаем, что $F(x)$ — непрерванная функция на $[a,b].$

(2) Пусть теперь $f$ — непрерывна в какой-то точке $x_0 \in [a,b]$, покажем тогда, что $F$ дифференцируема в точке $x_0$ и $F'(x_0) = f(x_0)$. 

Согласно определению дифференцируемости (см. определение [](#diff_of_map(function))), это значит, что нам нужно показать, что
$$
\lim_{h\to 0} \frac{F(x_0 + h) - F(x_0)}{h} = f(x_0),
$$
или
$$
\lim_{h \to 0} \frac{F(x_0 + h) - F(x_0) - f(x_0)\cdot h}{h} = 0,
$$
**т.е.,** для любого $\varepsilon >0$ можно всегда найти такое $\delta>0$, что при $|h|<\delta$,
$$
\left| \dfrac{F(x_0 + h) - F(x_0) - f(x_0)\cdot h}{h} \right| < \varepsilon.
$$

Пусть $x_0 + h = y \in [x_0 - \delta, x_0 + \delta] \cap [a,b] =: I$, **тогда нам нужно показать, что при любом $y \in I$ имеет место неравенство**
$$
\left| F(y) - F(x_0) - f(x_0) (y-x_0) \right| \le \varepsilon |y-x_0|.
$$

Так как функция $f$ непрерывна в точке $x_0$, то для любого $\varepsilon >0$ мы можем найти такое $\delta>0$, что существует такое $\delta >0$, что 
$$
|f(x) - f(x_0)| \le \varepsilon,
$$
для любого $x \in I$, **т.е.,**
$$
f(x_0) - \varepsilon \le f(x) \le f(x_0) + \varepsilon.
$$

Итак, пусть $y \in I : = [x_0 - \delta, x_0 + \delta] \cap [a,b]$, тогда возникают три случая. 

Если $y = x_0$, то $F(y) - F(x_0) - f(x_0)(y-x_0) = 0$ и неравенство
$$
\left| F(y) - F(x_0) - f(x_0) (y-x_0) \right| \le \varepsilon |y-x_0|
$$
очевидно выполняется, ибо мы получаем $0 \le 0.$

Пусть $y>x_0$ тогда
$$
F(y) - F(x_0) = \int_{[x_0,y]}f.
$$

Так как $x_0,y \in I$, $[x_0,y] \subseteq I$, то мы также имеем
$$
f(x_0) - \varepsilon \le f(x) \le f(x_0) + \varepsilon.
$$

Тогда по теореме [](#mega_theorem_for_int),
$$
\int_{[x_0,y]} f(x_0) - \varepsilon \le \int_{[x_0,y]}f(x) \le \int_{[x_0,y]} f(x_0) + \varepsilon
$$
**т.е.,**
$$
\left( f(x_0) - \varepsilon\right) (y-x_0) \le \int_{[x_0,y]}f(x) \le \left(f(x_0) + \varepsilon\right)(y-x_0).
$$

Но тогда мы и получаем, что
$$
\left| F(y) - F(x_0) - f(x_0) (y-x_0) \right| \le \varepsilon |y-x_0|,
$$
что и завершает доказательство.
:::

:::{warning}
Более простым языком эта теорема говорит, что имеет место равенство
$$
\mathrm{d} \int_{[a,x]}f = f\mathrm{d}x \mbox{ или } \left( \int_{[a,x]}f \right)'(x) = f(x).
$$
:::


Напомним, что (см. Определение [](#int1)) функция $F(x)$ в данном промежутке называется **интегралом** (=**первообразной**) для функции $f(x)$, если во всём этом промежутке $f(x)$ является производной для функции $F(x)$ или, что тоже, $f(x)\mathrm{d}x$ есть линейная дифференциальная форма, равная дифференциалу функции $F(x)$
$$
F'(x) = f(x) \quad \mbox{или} \quad  \mathrm{d}F = f(x) \mathrm{d}x.
$$

:::{prf:theorem}[Вторая фундаментальная теорема]
:name: second_fundamental_theorem
Пусть $a<b$, $a,b \in \mathbb{R}$ и пусть $f:[a,b] \to \mathbb{R}$ интегрируемая по Риману функция. Если $F:[a,b] \to \mathbb{R}$ — интеграл для $f$ на $[a,b]$, то
$$
\int_{[a,b]}f = F(b) - F(a).
$$
:::

(theorem-4-17)=
:::{prf:proof}
:class: dropdown
:nonumber:
Если мы покажем, что
$$
U(f,\lambda) \ge F(b) -F(a) \ge L(f,\lambda)
$$
для любого разбиения $\lambda = \lambda(I)$ промежутка $I$, то согласно Следствию [](#cor_for_supint), мы тогда получим, что
$$
\sup \int_{[a,b]}f \ge F(b) - F(a) \ge \inf \int_{[a,b]}f,
$$
а так как $f$ интегрируема по Риману, то крайние числа равны и более того
$$
\int_{[a,b]} f = \inf  \int_{[a,b]} f = \sup  \int_{[a,b]} f,
$$
откуда и будет следует, что
$$
\int_{[a,b]} f = F(b) - F(a).
$$

Итак, покажем, что 
$$
U(f,\lambda) \ge F(b) - F(a).
$$
для произвольного разбиения $\lambda$ промежутка $I$, так как $F$ — дифференцируема, то по Теореме [](#diff=contionous(for one varibale)), $F$ — непрерывна на $I$, а тогда по следствию [](#additive_of_a-lenght), 
$$
F(b) - F(a) = \sum_{A \in \lambda} F(A) = \sum_{A \in \lambda\setminus\varnothing}F(A).
$$

По определению [](#up_and_low_Riman),
$$
U(f,\lambda) : = \sum_{A \in \lambda\setminus \varnothing} \sup_{x \in A}f(x)|A|.
$$

Таким образом, нам осталось показать, что
$$
F(A) \le \sup_{x \in A} f(x) |A|, 
$$
для всех $A \in \lambda \setminus \varnothing.$ 

Если $A$ состоит из точки, то это очевидно, так как обе части неравенства равны нулю. Пусть теперь $A$ имеет один из четырёх видов $(c,d), [c,d], (c,d], [c,d)$, тогда $F(A) = F(d) - F(c)$. По теореме Лагранжа [](#Langrange), существует такая точка $\xi \in (c,d)$, что $F(d) - F(c) = F'(\xi)(d-c)$.

А так как $F'(x) = f(x)$ по условию на всём $I$, то мы получаем
$$
F(d) - F(c) = f(\xi) (d-c) = f(\xi)|A| \le \sup_{x \in A}f(x)|A|,
$$
что и требовалось доказать. 

Неравенство $F(b) - F(a) \le L(f,\lambda)$ доказывается аналогично.
:::


