# Функции, дифференцируемые на отрезке

В этом разделе мы рассматриваем функции от одной переменной.

## Функции, непрерывные на отрезке

:::{prf:theorem} о промежуточном значении
Если функция $f(x)$ непрерывна на отрезке $[a,b]$ и принимает на его концах значения разных знаков, то $f(x_0) = 0$ для некоторой точки $x_0 \in [a,b]$.    
:::
:::{prf:proof}
:class: dropdown
:nonumber:
Пусть $f(a)>0$, $f(b)<0$.  Построим последовательности $(a_n)$, $(b_n)$ следующим образом; $a_1:=a$, $b_1:=b$,
\begin{align*}
&a_{n+1}:= \begin{cases}
\frac{a_n +b_n}{2}, & \mbox{если $f(\frac{a_n +b_n}{2})>0$},\\
a_n, & \mbox{если $f(\frac{a_n +b_n}{2})<0$},
\end{cases}  & b_{n+1}:= \begin{cases}
\frac{a_n +b_n}{2}, & \mbox{если $f(\frac{a_n +b_n}{2})<0$},\\
a_n, & \mbox{если $f(\frac{a_n +b_n}{2})>0$},
\end{cases}
\end{align*}
при $n\ge 1$.

Покажем, что $a_{n+1}\le b_{n+1}$. По условию $a_1: = a < b =:b_1$. Пусть $a_n \le b_n$. Рассмотрим тогда $a_{n+1}$, $b_{n+1}$. Тогда, если $a_{n+1} = \frac{a_{n}+b_n}{2}$. то $b_{n+1} = b_n$, и тогда 
$$
a_{n+1} = \frac{a_n+b_n}{2} < \frac{b_n + b_n}{2} = b_n = b_{n+1}.
$$
Если же $a_{n+1} = a_n$, то $b_{n+1} = \frac{a_n + b_n}{2}$, и мы получаем
$$
b_{n+1} = \frac{a_n + b_n}{2} > \frac{a_n + a_n}{2} = a_n = a_{n+1}.
$$

Итак, мы показали, что $a_n \le b_n$.

Далее покажем, что $a_{n+1} \ge a_n$. Действительно, либо $a_2= a_1$, либо $a_2 = \frac{a_1 + b_1}{2} = \frac{a+b}{2} > \frac{a+a}{2} = a = a_1$. Пусть $a_{n} \ge a_{n-1}$, тогда если $a_{n+1} = \frac{a_n + b_n}{2}$, то $b_{n+1} = b_n$, то
$$
a_{n+1} = \frac{a_n + b_n}{2} \ge \frac{a_n + a_n}{2} = a_n,
$$
иначе $a_{n+1} = a_n$.

Аналогично показывается, что $b_{n+1} \le b_{n}$.

В итоге, мы получили две ограниченные\footnote{потому что они находятся в отрезке!} монотонные последовательности $(a_n)$, $(b_n)$. Тогда по теореме Вейерштрасса [](#W) у них есть предел.

С другой стороны, имеем
$$
b_{n+1} - a_{n+1} = \begin{cases}
\frac{a_n+b_n}{2} - a_n = \frac{b_n - a_n}{2}, & \mbox{если $b_{n+1} = \frac{a_n + b_n}{2}$ и тогда $a_{n+1} = a_n$}, \\
b_n - \frac{a_n + b_n}{2} = \frac{b_n - a_n}{2}, & \mbox{если $b_{n+1} = b_n$ и тогда $a_{n+1} = \frac{a_n + b_n}{2}$}
\end{cases}, 
$$
т. е.
$$
b_{n+1} - a_{n+1} = \frac{b_n - a_n}{2} = = \frac{b - a}{2^{n-1}}.
$$
:::

Тогда получаем
$$
\lim_{n \to \infty} (b_n - a_n) = \lim_{n \to \infty} \frac{b-a}{2^{n-1}} =0,
$$
т. е. $\lim_{n \to \infty} a_n = \lim_{n \to \infty} b_n =x_0.$

Так как функция непрерывна, и $x_0$ есть точка замыкания отрезка $[a,b]$, то по теореме  [](#lim=>for_any_sequence) $f(x_0) = \lim_{n \to \infty} f(a_n) = \lim_{n \to \infty} f(b_n)$. С другой стороны, по построению последовательности все $f(a_n) \ge 0$, $f(b_n)\le 0$, тогда по теореме [](#f<g=>lim) $ \lim_{n \to \infty} f(a_n)\ge 0$, $ \lim_{n \to \infty} f(и_n)\le 0$, но тогда $f(x_0) =  \lim_{n \to \infty} f(a_n) =  \lim_{n \to \infty} f(b_n) = 0$, что и требовалось. 


:::{prf:definition}
Значение функции, которое является наибольшим или наименьшим, называется **экстремальным**. Точку, в которой функция принимает экстремальное значение, называют **точкой экстремума**. Если же рассматривается какая-то окрестность точки $x_0$ и оказывается, что $x_0$ точка экстремума, то говорят, что $x_0$ есть точка **локального экстремума.** 
:::


:::{prf:theorem}
:name: continous_on_interval
Функция $f(x)$, непрерывная на отрезке $[a,b]$, ограничена на этом отрезке.
:::
:::{prf:proof}
:class: dropdown
:nonumber:
Докажем, что она ограничена сверху (ограниченность снизу доказывается аналогично). Пусть для любого $n\in \mathbb{N}$ на отрезке $[a,b]$ есть такая точка $x_n$, что $f(x_n) >n$. Мы получаем ограниченную последовательность $(x_n)$, тогда по теореме [](#from_bounded_sequence) можно выбрать сходящуюся подпоследовательность $(x_{n_k})$. Пусть тогда $\lim_{n\to \infty}x_{n_k} = x_0$. Согласно лемме [](#a<b), $a\le x_0 \le b$. 

Далее, так как $f(x)$ непрерывна на всём отрезке, то $f(x_0) = \lim_{x\to x_0}f(x)$, но тогда, согласно теореме [](#lim=>for_any_sequence), $f(x_0)  = \lim_{n\to \infty} f(x_{n_k})$, но мы предположили, что $f(x_{n_k}) > n_k$, тогда $\lim_{n\to \infty} f(x_{n_k}) = \infty$, что даёт противоречие.
:::

:::{prf:theorem} Вейерштрасс
:name: W2
Функция $f(x)$, непрерывная на отрезке $[a,b]$, достигает максимума и минимума в некоторых точках этого отрезка.
:::
:::{prf:proof}
:class: dropdown
:nonumber:

Рассмотрим множество $\{f(x),\, x \in [a,b] \} =: \mathrm{Im}(f)$. Очевидно, что оно не пусто. Согласно теореме [](#continous_on_interval), оно ограничено. Тогда, согласно принципу полноты Вейерштрасса (теорема [](#W=complete)), это множество имеет супремум и инфинум.

Покажем, что на отрезке $[a,b]$ есть такая точка $x_0$, для которой $f(x_0) = M: = \sup_{f(x) \in [a,b]}\{f(x)\}$. (Для инфиниума доказательство аналогичное).

Итак, множество $\{f(x),\, x\in  [a,b] \}$ ограничено и не пусто и имеет $\sup, \inf$. Тогда из определения супремума следует, что найдутся такие $f(x_n)$, что $M - \frac{1}{n} \le f(x_n) \le M$ для какой-то последовательности $(x_n)$ точек из $[a,b]$. Согласно теореме [](#from_bounded_sequence), можно выбрать сходящуюся подпоследовательность $(x_{n_k})$. Согласно лемме [](#choice_of_seqeunce), мы можем положить, что эта подпоследовательность сходится к $x_0$, но тогда согласно теореме [](#lim=>for_any_sequence), $f(x_0)  = \lim_{n \to \infty} f(x_{n_k})$, но так как $M - \frac{1}{n} \le f(x_n) \le M$, то по лемме о зажатой последовательности (теорема [](#sqeezy)) $f(x_0) = M$, что и требовалось доказать. 

:::

## Теоремы о среднем


:::{prf:theorem} Ферма 
:name: Ferma
Пусть функция $f(x)$ определена на отрезке $[a,b]$, $(a,b) \ni x_0$ — точка экстремума, и $f'(x_0)$ существует. Тогда $f'(x_0) = 0$.
:::

:::{prf:proof}
:class: dropdown
:nonumber:
Пусть $f(x_0) \le f(x)$ для всех $x \in [a,b]$, другой случай рассматривается аналогично. Рассмотрим пределы
$$
A:= \lim_{x \in \mathbb{R}_{>x_0}, x\to x_0} \frac{f(x) - f(x_0)}{x-x_0}, \qquad B:=\lim_{x \in \mathbb{R}_{x<x_0}, x\to x_0} \frac{f(x) - f(x_0)}{x-x_0}.
$$

Так как $f'(x_0) := \lim_{x\in \mathbb{R}, x \to x_0}$ существует, значит, по Теореме [](#limit_for_any_subset) эти два предела должны совпадать. Но так как  $f(x_0) \le f(x)$, то по теореме [](#f<g=>lim) $A\ge 0$, $B\le 0$, но тогда $f'(x_0) =0$, что и требовалось. 
:::


:::{prf:theorem} Ролль 
:name: Roll
Пусть функция $f(x)$ дифференцируема на отрезке $[a,b]$, причём $f(a) = f(b)$. Тогда существует такая точка $x_0 \in (a,b)$, что $f'(x_0) = 0.$
:::

:::{prf:proof}
:class: dropdown
:nonumber:
Согласно теореме Вейештрасса [](#W2), $f(x)$ достигает максимума $M$ и минимума $m$ на этом отрезке.

(1) Пусть $M = m$, тогда $f(x) = \mathrm{const}$, так как $m \le f(x) \le M$ для всех $x \in [a,b]$. Тогда в качестве $x_0$ можно взять любую точку из $(a,b)$.

(2) Пусть $f(x) \ne \mathrm{const}$, тогда найдётся точка $x_0 \in (a,b)$ такая, что $f(x_0) \ne f(a) =f(b)$. Положим $f(x) > f(a)$. Далее, согласно теореме Вейерштрасса [](#W2), найдётся точка $x_1 \in [a,b]$, в которой $f(x_1)$ максимальна. Тогда $x_1 \ne a,b$ и по теореме Ферма (теорема [](#Ferma)) мы получаем требуемое. 
:::


С геометрической точки зрения теорема утверждает, что если ординаты обоих концов гладкой кривой равны, то на кривой найдется точка, в которой касательная к кривой параллельна оси абсцисс.

Механический смысл теоремы в том, что если некоторое тело вернулось в исходную точку, двигаясь по незамкнутой линии, то оно обязано было хотя бы раз остановиться до нулевой скорости.

:::{prf:theorem} Лагранж 
:name: Langrange
Пусть функция $f(x)$ дифференцируема на отрезке $[a,b]$. Тогда существует такая точка $x_0 \in (a,b)$, что 
$$
f'(x_0) = \frac{f(b) - f(a)}{b-a}
$$
:::

:::{prf:proof}
:class: dropdown
:nonumber:
Рассмотрим функцию
$$
\varphi(x)  = f(x) - \frac{f(b) - f(a)}{b-a}(x-a).
$$
Эта функция дифференцируема на отрезке $[a,b]$ и $\varphi(a) = \varphi(b) =  f(a)$, тогда по теореме Ролля (теорема [](#Roll)) существует $x_0 \in (a,b)$ такая, что $\varphi'(x_0) = 0$, т. е.
$$
\varphi'(x_0) = f'(x_0) - \frac{f(b) - f(a)}{b-a} = 0,
$$
что и требовалось доказать.
:::

:::{warning}
Эту теорему часто записывают в виде $f(b) - f(a)=  f'(x_0)(b-a)$ и называют **формулой конечных приращений** или **теоремой о среднем значении**.
:::

:::{prf:theorem} Коши
:name: Coushy_for_functions
Пусть функции $f(x)$, $g(x)$ дифференцируемы на отрезке $[a,b]$, причём $g'(x) \ne 0$ на $(a,b)$. Тогда существует такая $c \in (a,b)$, что 
$$
\frac{f(b) -f(a)}{g(b) - g(a)} = \frac{f'(c)}{g'(c)}.
$$
:::

:::{prf:proof}
:class: dropdown
:nonumber:
Пусть
$$
F(x): = \bigl(f(b)-f(a) \bigr) (g(x)-g(a)) - ( f(x)- f(a)) \bigl(g(b) - g(a)\bigr).
$$

Ясно, что
$$
F'(x) = \bigl(f(b)-f(a) \bigr) g'(x) - f'(x)\bigl(g(b) - g(a)\bigr)
$$
и $F(a) = F(b) =0$. Тогда по теореме Ролля [](#Roll) существует $c\in (a,b)$ такая, что $F'(c) = 0.$

Если $g(b) = g(a)$, то по теореме Ролля нашлась бы точка $x_0 \in (a,b)$ такая, что $g'(x_0) = 0$, но по условию $g' \ne 0$ на всём $(a,b)$, тогда $g(b) \ne g(a)$. Поэтому из $F'(c)=0$ и следует требуемое.

:::