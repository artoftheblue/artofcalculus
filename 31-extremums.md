# Экстремум функции

Теперь у нас всё готово, чтобы исследовать функции на экстремумы. Прежде всего введём необходимые понятия.

:::{prf:definition}
:label: local_extremum
Точка $\m{a} \in \mathbb{R}^n$ называется **точкой локального максимума (минимума)** функции $f:\mathbb{R}^n \to \mathbb{R}$, если она определена в некоторой её окрестности $\mathscr{U}(\m{a})$ и $f(\m{x}) \ge f(\m{a})$ (**соотв.** $f(\m{x}) \le f(\m{a})$) для любой точки $\m{x} \in \mathscr{U}(\m{a}).$

Точки локального максимума и минимума называются точками **экстремума.**
:::

:::{warning}
В случае $f:\mathbb{R} \to \mathbb{R}$ исследование функции на экстремум, как правило, ограничивается исследованием знака $f'(x)$ в окрестности точки экстремума. Однако в случае когда $n\ge 2$, исследование функции $f:\mathbb{R}^n \to \mathbb{R}$ на экстремум уже, как правило, не ограничивается исследованием $(\mathrm{d}f)_\m{a}.$ 
:::

:::{prf:theorem} Необходимое условие экстремума
:label: required_extremum 
Если $\m{a} = (a_1,\ldots, a_n) \in \mathbb{R}^n$ — точка экстремума функции $f:\mathbb{R}^n \to \mathbb{R}$, тогда, если все частные производные $f'_{x_i}$, $1\le i \le n$ существуют в какой-то окрестности $\mathscr{U}(\m{a})$ точки $\m{a}$, то $(\mathrm{d}f)_\m{a}(\m{h}) = 0$ для любого $\m{h} \in \mathscr{U}(\m{a}),$ или
$$
\left.\frac{\partial f}{\partial x_1}\right|_\m{a} = \ldots = \left.\frac{\partial f}{\partial x_1}\right|_\m{a} = 0.   
$$
:::
:::{prf:proof}
:class: dropdown
:nonumber:
Рассмотрим $k$ функций $\varphi_k(t): = f(a_1,\ldots, a_{k-1}, t, a_{k+1}, \ldots, a_n)$, $1 \le k \le n$, где от каждого $t$ мы требуем, чтобы соответствующая точка лежала в окрестности $\mathscr{U}(\m{a}).$ Пусть $\m{a}$ — точка максимума, тогда, в частности, $f(a_1, \ldots, t, \ldots) \le f(\m{a})$ для любого $t$, т.е. $\varphi_k(t) \le f(\m{a})$ при каждом $1 \le k \le n$. Другими словами, $a_k$ — точка максимума для $\varphi_k(t)$. Тогда по теореме Ферма [](#Ferma), $\varphi'_k(a_k) = 0$, но $\varphi'_k(a_k) = f'_{x_k}(\m{a}) = 0$ для каждого $1 \le k \le n$, что и требовалось доказать.
:::



:::{prf:theorem} Достаточное условие экстремума
Пусть функция $f:\mathbb{R}^n \to \mathbb{R}$ является дважды дифференцируемой в окрестности $\mathscr{U}(\m{a})$ точки $\m{a} \in \mathbb{R}^n$, все $f''_{x_ix_j}$ непрерывны в $\m{a}$, и $(\mathrm{d}f_\m{a})(\m{h}) = 0$ для любого $\m{h} \in \mathscr{U}(\m{a}).$ 

1. Если $(\m{d}^2f)_\m{a}(\m{h}) >0 $ для любого $\m{h} \in \mathscr{U}(\m{a})$, то $\m{a}$ — локальный минимум.
2. Если $(\m{d}^2f)_\m{a}(\m{h}) <0 $ для любого $\m{h} \in \mathscr{U}(\m{a})$, то $\m{a}$ — локальный максимум.
3. Если существуют такие $\m{u}, \m{v} \in \mathscr{U}(\m{a})$, что $(\m{d}^2f)_\m{a}(\m{u}) >0$, $(\m{d}^2f)_\m{a}(\m{v}) <0$, то $\m{a}$ не является точкой экстремума. 

:::

:::{prf:proof}
:class: dropdown
:nonumber:
В окрестности $\mathscr{U}(a)$ точки $\m{a}$ имеем (Теорема [](#Tayl_for_2)),
$$
f(\m{a} + \m{h}) =f(\m{a}) + \nabla_\m{a}(f)(\m{h}) + \frac{1}{2} \m{h}^\top \m{H}_\m{a}(f) \m{h} + o(\|\m{h}\|^2), \qquad \m{h} \to \m{0}_n.
$$
по условию $\nabla_\m{a}(f)(\m{h}) = 0$, запишем это в следующем виде:
$$\begin{align*}
f(\m{a} + \m{h}) &=& f(\m{a}) +  \frac{1}{2} \m{h}^\top \m{H}_\m{a}(f) \m{h} + \alpha(\m{h}) \| \m{h}\|^2 \\
&=& f(\m{a}) + \|\m{h}\|^2 \left( \frac{1}{2}\frac{\m{h}^\top}{\|\m{h} \|} \m{H}_\m{a}(f) \frac{\m{h}}{\|\m{h} \|} + \alpha(\m{h}) \right) \\
&=&f(\m{a}) + \|\m{h}\|^2\left( \frac{1}{2} (\mathrm{d}^2f)_\m{a}\left(\frac{\m{h}} {\|\m{h}\|}\right) + \alpha(\m{h}) \right).
\end{align*}$$

Так как $(\mathrm{d}^2)_\m{a}(\m{h}) = \frac{1}{2} \m{h}^\top \m{H}_\m{a}(f) \m{h}$ — полином от переменных $h_1, \ldots, h_n$, то это непрерывная функция. С другой стороны, $\frac{\m{h}}{\| \m{h}\|}$ принадлежит единичной сфере $S^{n-1}: = \{\m{x} \in \mathbb{R}^n\, :\, \|\m{x}\| = 1\}$, тогда, согласно теореме [](#general_Weistrass), $(\mathrm{d}^2f)_\m{a}(\m{h})$ принимает максимальное и минимальное значение на сфере $S^{n-1}.$

(1) Пусть $(\m{d}^2f)_\m{a}(\m{h}) >0 $ для любого $\m{h} \in \mathscr{U}(\m{a})$, тогда если $\m{v} \in S^{n-1}$, то и $(\m{d}^2f)_\m{a}(\m{v}) >0 $ и тогда её минимальное значение на сфере тоже положительное, поэтому положим
$$
m: = \min_{\m{v} \in S^{n-1}} (\m{d}^2f)_\m{a}(\m{v}) > 0.
$$

Тогда

$$
f(\m{a} + \m{h}) = f(\m{a}) + \| \m{h}\|^2 \left( \frac{1}{2} (\mathrm{d}^2f)_\m{a}\left(\frac{\m{h}} {\|\m{h}\|}\right) + \alpha(\m{h}) \right) \\
\ge  f(\m{a}) + \| \m{h}\|^2 \left( \frac{m}{2} +\alpha(\m{h})\right),
$$

так как $\lim_{\m{h} \to \m{0}_n} \alpha(\m{h}) = 0$, то существует такая окрестность $\mathscr{V}$ точки $\m{0}_n$, что $|\alpha(\m{h})|< \frac{m}{4}$, тогда для любого $\m{h} \in \mathscr{V}$ получаем
$$
f(\m{a} + \m{h}) \ge f(\m{a}) + \frac{m}{4} \| \m{h}\|^2,
$$
что означает, что точка $\m{a}$ — локальный минимум.

(2) Доказательство аналогичное.

(3) Пусть существуют такие $\m{u}, \m{v} \in \mathscr{U}(\m{a})$, что $(\m{d}^2f)_\m{a}(\m{u}) >0$, $(\m{d}^2f)_\m{a}(\m{v}) <0$. Тогда имеем
$$\begin{align*}
f(\m{a} + t \m{u}) &=& f(\m{a}) + \frac{1}{2} (\mathrm{d}^2_\m{a}f)(t\m{u}) + \alpha(t \m{u})\| t \m{u}\|^2 \\
&=& f(\m{a}) + t^2 \left( \frac{1}{2} (\mathrm{d}^2_\m{a}f)(\m{u}) + \alpha(t \m{u})\| \m{u}\|^2 \right),
\end{align*}$$
аналогично, получаем
$$
f(\m{a} + t \m{v}) = f(\m{a}) + t^2 \left( \frac{1}{2} (\mathrm{d}^2_\m{a}f)(\m{v}) + \alpha(t \m{v})\| \m{v}\|^2 \right).
$$

Тогда при достаточно близких $t$ к нулю, с одной стороны $f(\m{a} + t \m{u}) < f(\m{a})$, а с другой $f(\m{a} + t \m{v}) > f(\m{a})$, это завершает доказательство. 
:::